import './polyfills.server.mjs';
import{R as M,S as De,a as ie}from"./chunk-UHE32XUF.mjs";import{$ as at,D as it,Da as ye,E as nt,Fa as pt,Ha as Ce,Ia as ct,L as ee,M as rt,Mb as lt,N as ot,Ob as Se,Q as U,Y as ve,_ as Ee,b as Ze,c as B,d as ue,db as he,e as de,eb as mt,g as fe,j as G,ja as st,l as xe,mc as te,o as ge,p as _e,s as et,ub as Ie,wc as ut,x as tt}from"./chunk-EKK5QDHO.mjs";import{A as Ye,Ac as Z,Cb as K,F as Ke,Fb as X,Gb as ce,Hb as me,J as Y,fc as Je,mc as le,pb as pe,qb as Xe,wc as J,zc as N}from"./chunk-H5UHAHI5.mjs";import{$a as E,$b as w,Aa as Be,Ad as He,Bc as se,Bd as Qe,Cc as Q,Cd as We,Ed as A,Fa as j,Ga as S,Jc as p,Ka as V,Kb as Pe,Kc as l,L as oe,Lc as I,Md as W,Oc as L,Pb as x,Qb as ke,Ra as D,Rb as o,Sa as T,Vb as je,X as ae,Xb as a,Yb as s,Zb as y,_a as v,_b as b,a as Fe,bc as h,dc as _,ec as c,f as Me,g as Ve,gb as H,ha as $e,hc as Re,mc as Le,nc as Ae,oc as Ge,pc as R,q as P,qc as d,rc as Ue,sc as f,wa as Oe,wb as r,x as k,xa as z,xb as g,y as Ne,yd as ze,zc as qe,zd as F}from"./chunk-TXWRNZDJ.mjs";import{a as $,b as O}from"./chunk-GHFNAT2I.mjs";var ne=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=j({token:t,factory:function(i){let n=null;return i?n=new(i||t):n=V(Ke),n},providedIn:"root"})}}return t})(),q=function(t){return t.FILE_NAME="fileName",t.DATE_TIME="dateTime",t}(q||{}),ht={cartImportExport:{file:{separator:","},import:{fileValidity:{maxSize:1,maxEntries:{[M.NEW_SAVED_CART]:100,[M.SAVED_CART]:100,[M.ACTIVE_CART]:10,[M.QUICK_ORDER]:10},allowedTypes:["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","text/csv",".csv"]},cartNameGeneration:{source:q.FILE_NAME}},export:{additionalColumns:[{name:{key:"name"},value:"product.name"},{name:{key:"price"},value:"totalPrice.formattedValue"}],messageEnabled:!0,downloadDelay:1e3,maxEntries:1e3,fileOptions:{fileName:"cart",extension:"csv",type:"text/csv"}}}},ft=(()=>{class t{static forRoot(){return{ngModule:t,providers:[Y(ht)]}}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=T({type:t})}static{this.\u0275inj=S({})}}return t})();function St(t,u){if(t&1){let e=h();a(0,"button",1),_("click",function(){let n=v(e).ngIf,m=c();return E(m.exportCsv(n))}),d(1),p(2,"cxTranslate"),s()}t&2&&(r(),f(" ",l(2,1,"exportEntries.exportProductToCsv"),`
`))}var Dt=["open"];function Tt(t,u){if(t&1){let e=h();a(0,"button",1),_("click",function(){let n=v(e).ngIf,m=c();return E(m.openDialog(n))}),d(1),p(2,"cxTranslate"),s()}t&2&&(r(),f(" ",l(2,1,"importEntries.importProducts"),`
`))}var xt=()=>({autofocus:".cx-message"});function bt(t,u){if(t&1&&(y(0,"cx-message",11),p(1,"cxTranslate")),t&2){let e=c(3);o("text",l(1,4,"importEntriesDialog.selectedSuccessfully"))("type",e.globalMessageType.MSG_TYPE_CONFIRMATION)("isVisibleCloseButton",!1)("cxFocus",se(6,xt))}}function wt(t,u){if(t&1&&(b(0),a(1,"div",9),x(2,bt,2,7,"cx-message",10),s(),w()),t&2){let e,i=c(2);r(2),o("ngIf",((e=i.form.get("file"))==null?null:e.value)&&((e=i.form.get("file"))==null?null:e.valid))}}function Ft(t,u){if(t&1){let e=h();a(0,"form",1),_("submit",function(){v(e);let n=c();return E(n.formSubmitSubject$.next(void 0))}),x(1,wt,3,1,"ng-container",2),a(2,"p",3),d(3),p(4,"cxTranslate"),s(),a(5,"p"),d(6),p(7,"cxTranslate"),s(),a(8,"label")(9,"cx-file-upload",4),d(10),p(11,"cxTranslate"),s(),y(12,"cx-form-errors",5),s(),a(13,"div",6)(14,"button",7),_("click",function(){v(e);let n=c();return E(n.close("Close Import Products Dialog"))}),d(15),p(16,"cxTranslate"),s(),a(17,"button",8),d(18),p(19,"cxTranslate"),s()()()}if(t&2){let e,i=c();o("formGroup",i.form),r(),o("cxFeature","a11yCartImportConfirmationMessage"),r(2),f(" ",l(4,11,"importEntriesDialog.importProductsSubtitle")," "),r(3),f(" ",l(7,13,"importEntriesDialog.importProductFileDetails")," "),r(3),o("formControl",i.form.get("file"))("accept",i.allowedTypes),r(),f(" ",l(11,15,"importEntriesDialog.selectFile")," "),r(2),o("control",i.form.get("file")),r(3),f(" ",l(16,17,"importEntriesDialog.cancel")," "),r(2),o("disabled",((e=i.form.get("file"))==null?null:e.status)==="PENDING"),r(),f(" ",l(19,19,"importEntriesDialog.upload")," ")}}var Te=t=>({count:t});function Mt(t,u){if(t&1&&(b(0),d(1),p(2,"cxTranslate"),w()),t&2){let e=c(2);r(),f(" ",I(2,1,"importEntriesDialog.summary.loaded",e.summary)," ")}}function Vt(t,u){if(t&1&&(b(0),d(1),p(2,"cxTranslate"),w()),t&2){let e=c(2);r(),f(" ",I(2,1,"importEntriesDialog.summary.loadedToCart",e.summary)," ")}}function Nt(t,u){if(t&1&&(a(0,"p",9),x(1,Mt,3,4,"ng-container",10)(2,Vt,3,4,"ng-container",11),s()),t&2){let e=c();o("ngSwitch",e.type),r(),o("ngSwitchCase",e.orderEntriesSource.QUICK_ORDER)}}function $t(t,u){if(t&1&&(a(0,"p"),d(1),p(2,"cxTranslate"),s()),t&2){let e=c();r(),f(" ",I(2,1,"importEntriesDialog.summary.loading",e.summary)," ")}}function Ot(t,u){if(t&1&&(a(0,"p",12),y(1,"cx-icon",13),d(2),p(3,"cxTranslate"),s()),t&2){let e=c();r(),o("type",e.iconTypes.SUCCESS),r(),f(" ",I(3,2,"importEntriesDialog.summary.successes",e.summary),`
`)}}function Bt(t,u){if(t&1&&(a(0,"li"),d(1),p(2,"cxTranslate"),s()),t&2){let e=u.$implicit;r(),f(" ",I(2,1,"importEntriesDialog.summary.messages."+e.statusCode,e)," ")}}function Pt(t,u){if(t&1&&(a(0,"ul"),x(1,Bt,3,4,"li",18),s()),t&2){let e=c(2);r(),o("ngForOf",e.summary.warningMessages)}}function kt(t,u){if(t&1){let e=h();a(0,"div",14)(1,"p"),y(2,"cx-icon",15),d(3),p(4,"cxTranslate"),a(5,"button",16),_("click",function(){v(e);let n=c();return E(n.toggleWarningList())}),d(6),p(7,"cxTranslate"),s()(),x(8,Pt,2,1,"ul",17),s()}if(t&2){let e=c();r(2),o("type",e.iconTypes.ERROR),r(),f(" ",I(4,4,"importEntriesDialog.summary.warning",Q(9,Te,e.summary.warningMessages.length))," "),r(3),f(" ",l(7,7,e.warningDetailsOpened?"importEntriesDialog.summary.hide":"importEntriesDialog.summary.show")," "),r(2),o("ngIf",e.warningDetailsOpened)}}function jt(t,u){if(t&1&&(a(0,"li"),d(1),p(2,"cxTranslate"),s()),t&2){let e=u.$implicit;r(),f(" ",I(2,1,"importEntriesDialog.summary.messages."+e.statusCode,e)," ")}}function Rt(t,u){if(t&1&&(a(0,"ul"),x(1,jt,3,4,"li",18),s()),t&2){let e=c(2);r(),o("ngForOf",e.summary.errorMessages)}}function Lt(t,u){if(t&1){let e=h();a(0,"div",19)(1,"p"),y(2,"cx-icon",20),d(3),p(4,"cxTranslate"),a(5,"button",16),_("click",function(){v(e);let n=c();return E(n.toggleErrorList())}),d(6),p(7,"cxTranslate"),s()(),x(8,Rt,2,1,"ul",17),s()}if(t&2){let e=c();r(2),o("type",e.iconTypes.RESET),r(),f(" ",I(4,4,"importEntriesDialog.summary.error",Q(9,Te,e.summary.errorMessages.length))," "),r(3),f(" ",l(7,7,e.errorDetailsOpened?"importEntriesDialog.summary.hide":"importEntriesDialog.summary.show")," "),r(2),o("ngIf",e.errorDetailsOpened)}}function At(t,u){if(t&1){let e=h();a(0,"button",21),_("click",function(){v(e);let n=c();return E(n.close("Close Import Products Dialog"))}),d(1),p(2,"cxTranslate"),s()}t&2&&(r(),f(" ",l(2,1,"importEntriesDialog.close")," "))}function Gt(t,u){t&1&&(a(0,"p"),d(1),p(2,"cxTranslate"),s()),t&2&&(r(),Ue(l(2,1,"importEntriesDialog.summary.info")))}function Ut(t,u){if(t&1&&(y(0,"cx-message",18),p(1,"cxTranslate")),t&2){let e=c(3);o("text",l(1,4,"importEntriesDialog.selectedSuccessfully"))("type",e.globalMessageType.MSG_TYPE_CONFIRMATION)("isVisibleCloseButton",!1)("cxFocus",se(6,xt))}}function qt(t,u){if(t&1&&(b(0),a(1,"div",16),x(2,Ut,2,7,"cx-message",17),s(),w()),t&2){let e,i=c(2);r(2),o("ngIf",((e=i.form.get("file"))==null?null:e.value)&&((e=i.form.get("file"))==null?null:e.valid))}}function zt(t,u){if(t&1){let e=h();a(0,"form",1),_("submit",function(){v(e);let n=c();return E(n.formSubmitSubject$.next(void 0))}),x(1,qt,3,1,"ng-container",2),a(2,"p",3),d(3),p(4,"cxTranslate"),s(),a(5,"p"),d(6),p(7,"cxTranslate"),s(),a(8,"label")(9,"cx-file-upload",4),_("update",function(){v(e);let n=c();return E(n.updateCartName())}),d(10),p(11,"cxTranslate"),s(),y(12,"cx-form-errors",5),s(),a(13,"div",6)(14,"label")(15,"span",7),d(16),p(17,"cxTranslate"),s(),y(18,"input",8)(19,"cx-form-errors",9),s()(),a(20,"div",6)(21,"label")(22,"span",7),d(23),p(24,"cxTranslate"),a(25,"span",10),d(26),p(27,"cxTranslate"),s()(),y(28,"textarea",11)(29,"cx-form-errors",9),a(30,"p",12),d(31),p(32,"cxTranslate"),s()()(),a(33,"div",13)(34,"button",14),_("click",function(){v(e);let n=c();return E(n.close("Close Import Products Dialog"))}),d(35),p(36,"cxTranslate"),s(),a(37,"button",15),d(38),p(39,"cxTranslate"),s()()()}if(t&2){let e,i=c();o("formGroup",i.form),r(),o("cxFeature","a11yCartImportConfirmationMessage"),r(2),f(" ",l(4,19,"importEntriesDialog.importProductsNewSavedCartSubtitle")," "),r(3),f(" ",l(7,21,"importEntriesDialog.importProductFileDetails")," "),r(3),o("formControl",i.form.get("file"))("accept",i.allowedTypes),r(),f(" ",l(11,23,"importEntriesDialog.selectFile")," "),r(2),o("control",i.form.get("file")),r(4),f(" ",l(17,25,"importEntriesDialog.savedCartName")," "),r(2),o("maxLength",i.nameMaxLength),r(),o("control",i.form.get("name")),r(4),f(" ",l(24,27,"importEntriesDialog.savedCartDescription")," "),r(3),f(" (",l(27,29,"importEntriesDialog.optional"),") "),r(2),o("maxLength",i.descriptionMaxLength),r(),o("control",i.form.get("description")),r(2),f(" ",I(32,31,"importEntriesDialog.charactersLeft",Q(38,Te,i.descriptionsCharacterLeft))," "),r(4),f(" ",l(36,34,"importEntriesDialog.cancel")," "),r(2),o("disabled",((e=i.form.get("file"))==null?null:e.status)==="PENDING"),r(),f(" ",l(39,36,"importEntriesDialog.upload")," ")}}function Ht(t,u){t&1&&(a(0,"h3",10),d(1),p(2,"cxTranslate"),s()),t&2&&(r(),f(" ",l(2,1,"importEntriesDialog.importProducts")," "))}function Qt(t,u){t&1&&(a(0,"div",10),d(1),p(2,"cxTranslate"),s()),t&2&&(r(),f(" ",l(2,1,"importEntriesDialog.importProducts")," "))}function Wt(t,u){if(t&1){let e=h();a(0,"cx-import-to-new-saved-cart-form",13),_("submitEvent",function(n){v(e);let m=c(2).ngIf,C=c();return E(C.importProducts(m,n))}),s()}if(t&2){let e=c(2).ngIf;o("type",e.type)}}function Yt(t,u){if(t&1){let e=h();a(0,"cx-import-entries-form",13),_("submitEvent",function(n){v(e);let m=c(2).ngIf,C=c();return E(C.importProducts(m,n))}),s()}if(t&2){let e=c(2).ngIf;o("type",e.type)}}function Kt(t,u){if(t&1&&(b(0),x(1,Wt,1,1,"cx-import-to-new-saved-cart-form",12)(2,Yt,1,1,"ng-template",null,1,L),w()),t&2){let e=R(3),i=c().ngIf,n=c();r(),o("ngIf",n.isNewCartForm(i))("ngIfElse",e)}}function Xt(t,u){if(t&1){let e=h();a(0,"cx-import-entries-summary",14),p(1,"async"),_("closeEvent",function(){v(e);let n=c(2);return E(n.close("Close Import Products Dialog"))}),s()}if(t&2){let e=c().ngIf,i=c();o("summary",l(1,2,i.summary$))("type",e.type)}}function Jt(t,u){if(t&1&&(b(0),x(1,Kt,4,2,"ng-container",11)(2,Xt,2,4,"ng-template",null,0,L),w()),t&2){let e=R(3),i=c();r(),o("ngIf",i.formState)("ngIfElse",e)}}function Zt(t,u){t&1&&y(0,"cx-import-order-entries")}function ei(t,u){t&1&&y(0,"cx-export-order-entries")}var ti=(()=>{class t{constructor(e,i,n,m){this.exportCsvFileService=e,this.importExportConfig=i,this.globalMessageService=n,this.translationService=m,this.columns=[{name:{key:"code"},value:"product.code"},{name:{key:"quantity"},value:"quantity"},...this.exportConfig?.additionalColumns??[]]}get exportConfig(){return this.importExportConfig.cartImportExport?.export}get separator(){return this.importExportConfig.cartImportExport?.file.separator}downloadCsv(e){this.getResolvedEntries(e).pipe(ae(1)).subscribe(i=>this.download(i))}resolveValue(e,i){return e.split(".").reduce((n,m)=>n?n[m]:"",i)?.toString()??""}resolveValues(e){return e.map(i=>this.columns.map(n=>this.resolveValue(n.value,i)))}getTranslatedColumnHeaders(){return Ne(this.columns.map(e=>this.translationService.translate(`exportEntries.columnNames.${e.name.key}`)))}displayExportMessage(){this.globalMessageService.add({key:"exportEntries.exportMessage"},pe.MSG_TYPE_INFO)}limitValues(e){return this.exportConfig?.maxEntries?e.splice(0,this.exportConfig?.maxEntries):e}getResolvedEntries(e){let i=this.limitValues(this.resolveValues(e));return this.getTranslatedColumnHeaders().pipe(k(n=>[n,...i]))}download(e){this.exportConfig?.messageEnabled&&this.displayExportMessage(),setTimeout(()=>{this.exportConfig!==void 0&&this.separator!==void 0&&this.exportCsvFileService.download(e,this.separator,this.exportConfig.fileOptions)},this.exportConfig?.downloadDelay??0)}static{this.\u0275fac=function(i){return new(i||t)(V(lt),V(ne),V(Xe),V(Je))}}static{this.\u0275prov=j({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),gt=(()=>{class t{constructor(e,i){this.exportEntriesService=e,this.contextService=i,this.styles="container",this.orderEntriesContext$=this.contextService.get(ie),this.entries$=this.orderEntriesContext$.pipe(z(n=>n?.getEntries?.()??P(void 0)))}exportCsv(e){this.exportEntriesService.downloadCsv(e)}static{this.\u0275fac=function(i){return new(i||t)(g(ti),g(te))}}static{this.\u0275cmp=D({type:t,selectors:[["cx-export-order-entries"]],hostVars:2,hostBindings:function(i,n){i&2&&je(n.styles)},decls:3,vars:5,consts:[["class","btn btn-tertiary cx-export-btn",3,"click",4,"ngIf"],[1,"btn","btn-tertiary","cx-export-btn",3,"click"]],template:function(i,n){if(i&1&&(x(0,St,3,3,"button",0),p(1,"async"),p(2,"async")),i&2){let m;o("ngIf",((m=l(1,1,n.entries$))==null?null:m.length)>0&&l(2,3,n.entries$))}},dependencies:[F,A,N],encapsulation:2,changeDetection:0})}}return t})(),be=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=T({type:t})}static{this.\u0275inj=S({imports:[W,Ye,Z,le,X.withConfig({cmsComponents:{ExportOrderEntriesComponent:{component:gt}}})]})}}return t})(),_t=(()=>{class t{constructor(e,i){this.launchDialogService=e,this.contextService=i,this.subscription=new Fe,this.orderEntriesContext$=this.contextService.get(ie)}openDialog(e){this.launchDialogService.openDialogAndSubscribe("IMPORT_TO_CART",this.element,{orderEntriesContext:e})}static{this.\u0275fac=function(i){return new(i||t)(g(U),g(te))}}static{this.\u0275cmp=D({type:t,selectors:[["cx-import-order-entries"]],viewQuery:function(i,n){if(i&1&&Le(Dt,5),i&2){let m;Ae(m=Ge())&&(n.element=m.first)}},decls:2,vars:3,consts:[["class","btn btn-tertiary cx-import-btn",3,"click",4,"ngIf"],[1,"btn","btn-tertiary","cx-import-btn",3,"click"]],template:function(i,n){i&1&&(x(0,Tt,3,3,"button",0),p(1,"async")),i&2&&o("ngIf",l(1,1,n.orderEntriesContext$))},dependencies:[F,A,N],encapsulation:2,changeDetection:0})}}return t})(),vt=(()=>{class t{constructor(){}csvDataToProduct(e){return e.map(i=>({productCode:i[0],quantity:Number(i[1])}))}isDataParsableToProducts(e){let i=new RegExp(/(?:\s|^)\d+(?=\s|$)/);return e.length>0&&e.every(n=>i.test(n[1]))}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=j({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),Et=(()=>{class t{constructor(e,i,n,m,C){this.launchDialogService=e,this.importToCartService=i,this.importCsvService=n,this.filesFormValidators=m,this.importExportConfig=C,this.formSubmitSubject$=new Me,this.globalMessageType=pe,this.submitEvent=new H}ngOnInit(){this.form=this.buildForm(),this.formSubmitSubject$.pipe(Be(()=>{this.form.invalid&&(this.form.markAllAsTouched(),ut.deepUpdateValueAndValidity(this.form))}),z(()=>this.form.statusChanges.pipe(Oe(this.form.get("file")?.status),oe(e=>e!=="PENDING"),ae(1))),oe(e=>e==="VALID")).subscribe(()=>{this.save()})}close(e){this.launchDialogService.closeDialog(e)}save(){let e=this.form.get("file")?.value?.[0];this.separator!==void 0&&this.importCsvService.loadFile(e,this.separator).subscribe(i=>{this.submitEvent.emit({products:this.importToCartService.csvDataToProduct(i)})})}buildForm(){let e=new fe({});return e.setControl("file",new G("",[B.required,this.filesFormValidators.maxSize(this.maxSize)],[i=>this.separator!==void 0?this.importCsvService.validateFile(i.value[0],{separator:this.separator,isDataParsable:this.importToCartService.isDataParsableToProducts,maxEntries:this.maxEntries}):P(null)])),e}get allowedTypes(){return this.importExportConfig.cartImportExport?.import?.fileValidity?.allowedTypes}get maxSize(){return this.importExportConfig.cartImportExport?.import?.fileValidity?.maxSize}get maxEntries(){return this.importExportConfig.cartImportExport?.import?.fileValidity?.maxEntries?.[this.type]}get separator(){return this.importExportConfig.cartImportExport?.file.separator}static{this.\u0275fac=function(i){return new(i||t)(g(U),g(vt),g(Se),g(Ie),g(ne))}}static{this.\u0275cmp=D({type:t,selectors:[["cx-import-entries-form"]],inputs:{type:"type"},outputs:{submitEvent:"submitEvent"},decls:1,vars:1,consts:[[3,"formGroup","submit",4,"ngIf"],[3,"submit","formGroup"],[4,"cxFeature"],[1,"cx-import-entries-subtitle"],[3,"formControl","accept"],["prefix","formErrors.file",3,"control"],[1,"cx-import-entries-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled"],["aria-live","assertive","aria-atomic","true"],[3,"text","type","isVisibleCloseButton","cxFocus",4,"ngIf"],[3,"text","type","isVisibleCloseButton","cxFocus"]],template:function(i,n){i&1&&x(0,Ft,20,21,"form",0),i&2&&o("ngIf",n.form)},dependencies:[F,xe,ue,de,ge,_e,ye,ee,Ce,he,K,N],encapsulation:2,changeDetection:0})}}return t})(),ii=(()=>{class t{constructor(){this.iconTypes=ve,this.orderEntriesSource=M,this.warningDetailsOpened=!1,this.errorDetailsOpened=!1,this.closeEvent=new H}close(e){this.closeEvent.emit(e)}toggleWarningList(){this.warningDetailsOpened=!this.warningDetailsOpened}toggleErrorList(){this.errorDetailsOpened=!this.errorDetailsOpened}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=D({type:t,selectors:[["cx-import-entries-summary"]],inputs:{type:"type",summary:"summary"},outputs:{closeEvent:"closeEvent"},decls:11,vars:7,consts:[["loading",""],["info",""],[1,"cx-import-entries-summary-status"],[3,"ngSwitch",4,"ngIf","ngIfElse"],["class","cx-import-entries-summary-successes",4,"ngIf"],["class","cx-import-entries-summary-warnings",4,"ngIf"],["class","cx-import-entries-summary-errors",4,"ngIf"],[1,"cx-import-entries-summary-footer"],["class","btn btn-secondary","type","button",3,"click",4,"ngIf","ngIfElse"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"cx-import-entries-summary-successes"],[1,"success",3,"type"],[1,"cx-import-entries-summary-warnings"],[1,"warning",3,"type"],[1,"btn","btn-tertiary",3,"click"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"cx-import-entries-summary-errors"],[1,"error",3,"type"],["type","button",1,"btn","btn-secondary",3,"click"]],template:function(i,n){if(i&1&&(a(0,"div",2),x(1,Nt,3,2,"p",3)(2,$t,3,4,"ng-template",null,0,L),s(),x(4,Ot,4,5,"p",4)(5,kt,9,11,"div",5)(6,Lt,9,11,"div",6),a(7,"div",7),x(8,At,3,3,"button",8)(9,Gt,3,3,"ng-template",null,1,L),s()),i&2){let m=R(3),C=R(10);r(),o("ngIf",!n.summary.loading)("ngIfElse",m),r(3),o("ngIf",n.summary.successesCount>0),r(),o("ngIf",n.summary.warningMessages.length>0),r(),o("ngIf",n.summary.errorMessages.length>0),r(2),o("ngIf",!n.summary.loading)("ngIfElse",C)}},dependencies:[ze,F,He,Qe,We,Ee,N],encapsulation:2,changeDetection:0})}}return t})(),ni=(()=>{class t extends Et{get descriptionsCharacterLeft(){return this.descriptionMaxLength-(this.form.get("description")?.value?.length||0)}constructor(e,i,n,m,C,re){super(e,i,n,m,C),this.launchDialogService=e,this.importToCartService=i,this.importCsvService=n,this.filesFormValidators=m,this.importExportConfig=C,this.datePipe=re,this.descriptionMaxLength=250,this.nameMaxLength=50,this.submitEvent=new H}save(){let e=this.form.get("file")?.value?.[0];this.separator!==void 0&&this.importCsvService.loadFile(e,this.separator).subscribe(i=>{this.submitEvent.emit({products:this.importToCartService.csvDataToProduct(i),savedCartInfo:{name:this.form.get("name")?.value,description:this.form.get("description")?.value}})})}buildForm(){let e=new fe({});return e.setControl("file",new G("",[B.required,this.filesFormValidators.maxSize(this.maxSize)],[i=>this.separator!==void 0?this.importCsvService.validateFile(i.value[0],{separator:this.separator,isDataParsable:this.importToCartService.isDataParsableToProducts,maxEntries:this.maxEntries}):P(null)])),e.setControl("name",new G("",[B.required,B.maxLength(this.nameMaxLength)])),e.setControl("description",new G("",[B.maxLength(this.descriptionMaxLength)])),e}updateCartName(){let e=this.form.get("name");if(e&&!e?.value&&this.cartNameGeneration?.source)switch(this.cartNameGeneration.source){case q.FILE_NAME:{this.setFieldValueByFileName(e);break}case q.DATE_TIME:{this.setFieldValueByDatetime(e);break}default:break}}setFieldValueByFileName(e){let i=this.form.get("file")?.value?.[0]?.name?.replace(/\.[^/.]+$/,"");e.setValue(i)}setFieldValueByDatetime(e){let i=new Date,n=this.cartNameGeneration?.fromDateOptions,m=n?.mask,C=n?.prefix??"",re=n?.suffix??"",Ct=m?this.datePipe.transform(i,m):this.datePipe.transform(i);e.setValue(`${C}${Ct}${re}`)}get cartNameGeneration(){return this.importExportConfig.cartImportExport?.import?.cartNameGeneration}static{this.\u0275fac=function(i){return new(i||t)(g(U),g(vt),g(Se),g(Ie),g(ne),g(J))}}static{this.\u0275cmp=D({type:t,selectors:[["cx-import-to-new-saved-cart-form"]],outputs:{submitEvent:"submitEvent"},features:[qe([J]),Pe],decls:1,vars:1,consts:[[3,"formGroup","submit",4,"ngIf"],[3,"submit","formGroup"],[4,"cxFeature"],[1,"cx-import-entries-subtitle"],[3,"update","formControl","accept"],["prefix","formErrors.file",3,"control"],[1,"cx-import-entries-row"],[1,"cx-import-entries-label","label-content"],["formControlName","name","required","","type","text",1,"form-control",3,"maxLength"],[3,"control"],[1,"cx-import-entries-label-optional"],["formControlName","description","rows","5",1,"form-control",3,"maxLength"],[1,"cx-import-entries-input-hint"],[1,"cx-import-entries-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled"],["aria-live","assertive","aria-atomic","true"],[3,"text","type","isVisibleCloseButton","cxFocus",4,"ngIf"],[3,"text","type","isVisibleCloseButton","cxFocus"]],template:function(i,n){i&1&&x(0,zt,40,40,"form",0),i&2&&o("ngIf",n.form)},dependencies:[F,xe,Ze,ue,de,tt,ge,_e,et,ye,ee,Ce,he,K,N],encapsulation:2,changeDetection:0})}}return t})(),ri=(()=>{class t{constructor(e){this.launchDialogService=e,this.iconTypes=ve,this.focusConfig={trap:!0,block:!0,autofocus:"button",focusOnEscape:!0},this.formState=!0,this.summary$=new Ve({loading:!1,cartName:"",count:0,total:0,successesCount:0,warningMessages:[],errorMessages:[]}),this.context$=this.launchDialogService.data$.pipe(k(i=>i.orderEntriesContext)),me("a11yExpandedFocusIndicator"),me("a11yVisibleFocusOverflows")}isNewCartForm(e){return e.type===M.NEW_SAVED_CART}close(e){this.launchDialogService.closeDialog(e)}importProducts(e,{products:i,savedCartInfo:n}){this.formState=!1,this.summary$.next(O($({},this.summary$.value),{loading:!0,total:i.length,cartName:n?.name})),e.addEntries(i,n).pipe($e(()=>{this.summary$.next(O($({},this.summary$.value),{loading:!1}))})).subscribe(m=>{this.populateSummary(m)})}populateSummary(e){e.statusCode===De.SUCCESS?this.summary$.next(O($({},this.summary$.value),{count:this.summary$.value.count+1,successesCount:this.summary$.value.successesCount+1})):e.statusCode===De.LOW_STOCK?this.summary$.next(O($({},this.summary$.value),{count:this.summary$.value.count+1,warningMessages:[...this.summary$.value.warningMessages,e]})):this.summary$.next(O($({},this.summary$.value),{count:this.summary$.value.count+1,errorMessages:[...this.summary$.value.errorMessages,e]}))}static{this.\u0275fac=function(i){return new(i||t)(g(U))}}static{this.\u0275cmp=D({type:t,selectors:[["cx-import-entries-dialog"]],decls:14,vars:16,consts:[["importSummary",""],["reducedForm",""],["role","dialog","aria-labelledby","dialogTitle",1,"cx-import-entries-dialog",3,"esc","cxFocus"],[1,"cx-import-entries-container"],[1,"modal-header","cx-import-entries-header"],["id","dialogTitle","class","cx-import-entries-title modal-title",4,"cxFeature"],["type","button",1,"cx-import-entries-close","close",3,"click","title","disabled"],["aria-hidden","true"],[3,"type"],[4,"ngIf"],["id","dialogTitle",1,"cx-import-entries-title","modal-title"],[4,"ngIf","ngIfElse"],[3,"type","submitEvent",4,"ngIf","ngIfElse"],[3,"submitEvent","type"],[3,"closeEvent","summary","type"]],template:function(i,n){if(i&1&&(a(0,"div",2),_("esc",function(){return n.close("Escape clicked")}),a(1,"div",3)(2,"div",4),b(3),x(4,Ht,3,3,"h3",5)(5,Qt,3,3,"div",5),w(),a(6,"button",6),p(7,"cxTranslate"),p(8,"async"),p(9,"cxTranslate"),_("click",function(){return n.close("Close Import Products Dialog")}),a(10,"span",7),y(11,"cx-icon",8),s()()(),x(12,Jt,4,2,"ng-container",9),p(13,"async"),s()()),i&2){let m;o("cxFocus",n.focusConfig),r(4),o("cxFeature","a11yDialogsHeading"),r(),o("cxFeature","!a11yDialogsHeading"),r(),Re("title",l(7,8,"importEntriesDialog.close")),o("disabled",(m=l(8,10,n.summary$))==null?null:m.loading),ke("aria-label",l(9,12,"importEntriesDialog.close")),r(5),o("type",n.iconTypes.CLOSE),r(),o("ngIf",l(13,14,n.context$))}},dependencies:[F,Ee,ee,K,Et,ii,ni,A,N],encapsulation:2,changeDetection:0})}}return t})(),oi={launch:{IMPORT_TO_CART:{inlineRoot:!0,component:ri,dialogType:ot.DIALOG}}},we=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=T({type:t})}static{this.\u0275inj=S({providers:[Y(oi)],imports:[W,it,nt,pt,at,rt,ct,Z,mt,ce,X.withConfig({cmsComponents:{ImportOrderEntriesComponent:{component:_t}}}),ce]})}}return t})(),ai=(()=>{class t{constructor(e){this.contextService=e,this.context$=this.contextService.get(ie),this.shouldDisplayImport$=this.context$.pipe(k(i=>!!i?.addEntries)),this.shouldDisplayExport$=this.context$.pipe(z(i=>i?.getEntries?.()??P([])),k(i=>!!i?.length))}static{this.\u0275fac=function(i){return new(i||t)(g(te))}}static{this.\u0275cmp=D({type:t,selectors:[["cx-import-export-order-entries"]],decls:4,vars:6,consts:[[4,"ngIf"]],template:function(i,n){i&1&&(x(0,Zt,1,0,"cx-import-order-entries",0),p(1,"async"),x(2,ei,1,0,"cx-export-order-entries",0),p(3,"async")),i&2&&(o("ngIf",l(1,2,n.shouldDisplayImport$)),r(2),o("ngIf",l(3,4,n.shouldDisplayExport$)))},dependencies:[_t,gt,F,A],encapsulation:2,changeDetection:0})}}return t})(),yt=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=T({type:t})}static{this.\u0275inj=S({imports:[st,X.withConfig({cmsComponents:{ImportExportOrderEntriesComponent:{component:ai}}}),Z,le,we,be,W]})}}return t})();var Bi=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=T({type:t})}static{this.\u0275inj=S({imports:[ft.forRoot(),be,we,yt]})}}return t})();export{Bi as ImportExportModule};
